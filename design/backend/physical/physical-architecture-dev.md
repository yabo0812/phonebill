# ë¬¼ë¦¬ ì•„í‚¤í…ì²˜ ì„¤ê³„ì„œ - ê°œë°œí™˜ê²½

## 1. ê°œìš”

### 1.1 ì„¤ê³„ ëª©ì 
- í†µì‹ ìš”ê¸ˆ ê´€ë¦¬ ì„œë¹„ìŠ¤ì˜ **ê°œë°œí™˜ê²½** ë¬¼ë¦¬ ì•„í‚¤í…ì²˜ ì„¤ê³„
- MVP ë‹¨ê³„ì˜ ë¹ ë¥¸ ê°œë°œê³¼ ê²€ì¦ì„ ìœ„í•œ ìµœì†Œ êµ¬ì„±
- ë¹„ìš© íš¨ìœ¨ì„±ê³¼ ê°œë°œ í¸ì˜ì„± ìš°ì„ 

### 1.2 ì„¤ê³„ ì›ì¹™
- **MVP ìš°ì„ **: ë¹ ë¥¸ ê°œë°œê³¼ ê²€ì¦ì„ ìœ„í•œ ìµœì†Œ êµ¬ì„±
- **ë¹„ìš© ìµœì í™”**: Spot Instances, Pod ê¸°ë°˜ ë°±í‚¹ì„œë¹„ìŠ¤ í™œìš©
- **ê°œë°œ í¸ì˜ì„±**: ë³µì¡í•œ ì„¤ì • ìµœì†Œí™”, ë¹ ë¥¸ ë°°í¬
- **ë‹¨ìˆœì„±**: ìš´ì˜ ë³µì¡ë„ ìµœì†Œí™”

### 1.3 ì°¸ì¡° ì•„í‚¤í…ì²˜
- ë§ˆìŠ¤í„° ì•„í‚¤í…ì²˜: design/backend/physical/physical-architecture.md
- HighLevelì•„í‚¤í…ì²˜ì •ì˜ì„œ: design/high-level-architecture.md
- ë…¼ë¦¬ì•„í‚¤í…ì²˜: design/backend/logical/logical-architecture.md
- ìœ ì €ìŠ¤í† ë¦¬: design/userstory.md

## 2. ê°œë°œí™˜ê²½ ì•„í‚¤í…ì²˜ ê°œìš”

### 2.1 í™˜ê²½ íŠ¹ì„±
- **ëª©ì **: ë¹ ë¥¸ ê°œë°œê³¼ ê²€ì¦
- **ì‚¬ìš©ì**: ê°œë°œíŒ€ (5ëª…)
- **ê°€ìš©ì„±**: 95% (ì›” 36ì‹œê°„ ë‹¤ìš´íƒ€ì„ í—ˆìš©)
- **í™•ì¥ì„±**: ì œí•œì  (ê³ ì • ë¦¬ì†ŒìŠ¤)
- **ë³´ì•ˆ**: ê¸°ë³¸ ë³´ì•ˆ (ë³µì¡í•œ ë³´ì•ˆ ì„¤ì • ìµœì†Œí™”)

### 2.2 ì „ì²´ ì•„í‚¤í…ì²˜

ğŸ“„ **[ê°œë°œí™˜ê²½ ë¬¼ë¦¬ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨](./physical-architecture-dev.mmd)**

**ì£¼ìš” êµ¬ì„± ìš”ì†Œ:**
- NGINX Ingress Controller â†’ AKS ê¸°ë³¸ í´ëŸ¬ìŠ¤í„°
- ì• í”Œë¦¬ì¼€ì´ì…˜ Pod: Auth, Bill-Inquiry, Product-Change, KOS-Mock Service
- ë°±í‚¹ì„œë¹„ìŠ¤ Pod: PostgreSQL (Local Storage), Redis (Memory Only)

## 3. ì»´í“¨íŒ… ì•„í‚¤í…ì²˜

### 3.1 Azure Kubernetes Service (AKS) êµ¬ì„±

#### 3.1.1 í´ëŸ¬ìŠ¤í„° ì„¤ì •

| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------| 
| Kubernetes ë²„ì „ | 1.29 | ì•ˆì •í™”ëœ ìµœì‹  ë²„ì „ |
| ì„œë¹„ìŠ¤ ê³„ì¸µ | Basic | ë¹„ìš© ìµœì í™” |
| Network Plugin | Azure CNI | Azure ë„¤ì´í‹°ë¸Œ ë„¤íŠ¸ì›Œí‚¹ |
| Network Policy | Kubernetes Network Policies | ê¸°ë³¸ Pod í†µì‹  ì œì–´ |
| Ingress Controller | NGINX Ingress Controller | ì˜¤í”ˆì†ŒìŠ¤ Ingress |
| DNS | CoreDNS | í´ëŸ¬ìŠ¤í„° DNS |

#### 3.1.2 ë…¸ë“œ í’€ êµ¬ì„±

| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------| 
| VM í¬ê¸° | Standard_B2s | 2 vCPU, 4GB RAM |
| ë…¸ë“œ ìˆ˜ | 2 | ê³ ì • ë…¸ë“œ ìˆ˜ |
| ìë™ ìŠ¤ì¼€ì¼ë§ | Disabled | ë¹„ìš© ì ˆì•½ì„ ìœ„í•œ ê³ ì • í¬ê¸° |
| ìµœëŒ€ Pod ìˆ˜ | 30 | ë…¸ë“œë‹¹ ìµœëŒ€ Pod |
| ê°€ìš© ì˜ì—­ | Zone-1 | ë‹¨ì¼ ì˜ì—­ (ë¹„ìš© ì ˆì•½) |
| ê°€ê²© ì •ì±… | Spot Instance | 70% ë¹„ìš© ì ˆì•½ |

### 3.2 ì„œë¹„ìŠ¤ë³„ ë¦¬ì†ŒìŠ¤ í• ë‹¹

#### 3.2.1 ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤
| ì„œë¹„ìŠ¤ | CPU Requests | Memory Requests | CPU Limits | Memory Limits | Replicas |
|--------|--------------|-----------------|------------|---------------|----------|
| Auth Service | 50m | 128Mi | 200m | 256Mi | 1 |
| Bill-Inquiry Service | 100m | 256Mi | 500m | 512Mi | 1 |
| Product-Change Service | 100m | 256Mi | 500m | 512Mi | 1 |
| KOS-Mock Service | 50m | 128Mi | 200m | 256Mi | 1 |

#### 3.2.2 ë°±í‚¹ ì„œë¹„ìŠ¤
| ì„œë¹„ìŠ¤ | CPU Requests | Memory Requests | CPU Limits | Memory Limits | Storage |
|--------|--------------|-----------------|------------|---------------|---------|
| PostgreSQL | 500m | 1Gi | 1000m | 2Gi | 20GB (Azure Disk Standard) |
| Redis | 100m | 256Mi | 500m | 1Gi | Memory Only |

#### 3.2.3 ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ êµ¬ì„±
| ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ | ì œê³µì | ì„±ëŠ¥ | ìš©ë„ | ë°±ì—… ì •ì±… |
|----------------|--------|------|------|-----------|
| managed-standard | Azure Disk | Standard HDD | ê°œë°œìš© ë°ì´í„° ì €ì¥ | ìˆ˜ë™ ë°±ì—… |
| managed-premium | Azure Disk | Premium SSD | ë¯¸ì‚¬ìš© (ë¹„ìš© ì ˆì•½) | - |

## 4. ë„¤íŠ¸ì›Œí¬ ì•„í‚¤í…ì²˜

### 4.1 ë„¤íŠ¸ì›Œí¬ êµ¬ì„±

#### 4.1.1 ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€

ğŸ“„ **[ê°œë°œí™˜ê²½ ë„¤íŠ¸ì›Œí¬ ë‹¤ì´ì–´ê·¸ë¨](./network-dev.mmd)**

| ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ìš”ì†Œ | ì£¼ì†Œ ëŒ€ì—­ | ìš©ë„ | íŠ¹ë³„ ì„¤ì • |
|-----------------|----------|------|-----------|
| Virtual Network | phonebill-vnet-dev | ì „ì²´ ë„¤íŠ¸ì›Œí¬ | Azure CNI ì‚¬ìš© |
| Public Subnet | 10.0.1.0/24 | Load Balancer, Ingress | ì¸í„°ë„· ì—°ê²° |
| Application Subnet | 10.0.2.0/24 | ì• í”Œë¦¬ì¼€ì´ì…˜ Pod | Private í†µì‹  |
| Data Subnet | 10.0.3.0/24 | ë°ì´í„°ë² ì´ìŠ¤, ìºì‹œ | ì œí•œì  ì ‘ê·¼ |
| Management Subnet | 10.0.4.0/24 | ëª¨ë‹ˆí„°ë§, ê´€ë¦¬ | ê°œë°œìš© ë„êµ¬ |

#### 4.1.2 ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ

**ê¸°ë³¸ Network Policy:**
| ì •ì±… ìœ í˜• | ì„¤ì • | ì„¤ëª… |
|-----------|------|---------|
| Default Policy | ALLOW_ALL_NAMESPACES | ê°œë°œ í¸ì˜ì„±ì„ ìœ„í•œ í—ˆìš©ì  ì •ì±… |
| Complexity Level | Basic | ë‹¨ìˆœí•œ ë³´ì•ˆ êµ¬ì„± |

**Database ì ‘ê·¼ ì œí•œ:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| í—ˆìš© ëŒ€ìƒ | Application Tier Pods | tier: application ë ˆì´ë¸” |
| í”„ë¡œí† ì½œ | TCP | ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° |
| í¬íŠ¸ | 5432, 6379 | PostgreSQL, Redis í¬íŠ¸ |

### 4.2 ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬

| ì„œë¹„ìŠ¤ | ë‚´ë¶€ ì£¼ì†Œ | í¬íŠ¸ | ìš©ë„ |
|--------|-----------|------|------|
| Auth Service | auth-service.phonebill-dev.svc.cluster.local | 8080 | ì‚¬ìš©ì ì¸ì¦ API |
| Bill-Inquiry Service | bill-inquiry-service.phonebill-dev.svc.cluster.local | 8080 | ìš”ê¸ˆ ì¡°íšŒ API |
| Product-Change Service | product-change-service.phonebill-dev.svc.cluster.local | 8080 | ìƒí’ˆ ë³€ê²½ API |
| PostgreSQL | postgresql.phonebill-dev.svc.cluster.local | 5432 | ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ |
| Redis | redis.phonebill-dev.svc.cluster.local | 6379 | ìºì‹œ ì„œë²„ |

## 5. ë°ì´í„° ì•„í‚¤í…ì²˜

### 5.1 ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì„±

#### 5.1.1 ì£¼ ë°ì´í„°ë² ì´ìŠ¤ Pod êµ¬ì„±

**ê¸°ë³¸ ì„¤ì •:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ | bitnami/postgresql:16 | ì•ˆì •í™”ëœ PostgreSQL 16 |
| CPU ìš”ì²­ | 500m | ê¸°ë³¸ CPU í• ë‹¹ |
| Memory ìš”ì²­ | 1Gi | ê¸°ë³¸ ë©”ëª¨ë¦¬ í• ë‹¹ |
| CPU ì œí•œ | 1000m | ìµœëŒ€ CPU ì‚¬ìš©ëŸ‰ |
| Memory ì œí•œ | 2Gi | ìµœëŒ€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ |

**ìŠ¤í† ë¦¬ì§€ êµ¬ì„±:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ | managed-standard | Azure Disk Standard |
| ìŠ¤í† ë¦¬ì§€ í¬ê¸° | 20Gi | ê°œë°œìš© ì¶©ë¶„í•œ ìš©ëŸ‰ |
| ë§ˆìš´íŠ¸ ê²½ë¡œ | /bitnami/postgresql | ë°ì´í„° ì €ì¥ ê²½ë¡œ |
| ë°±ì—… ì „ëµ | Azure Backup | ì¼ì¼ ìë™ ë°±ì—… |

**ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •ê°’:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| ìµœëŒ€ ì—°ê²° ìˆ˜ | 100 | ë™ì‹œ ì—°ê²° ì œí•œ |
| Shared Buffers | 256MB | ê³µìœ  ë²„í¼ í¬ê¸° |
| Effective Cache Size | 1GB | íš¨ê³¼ì  ìºì‹œ í¬ê¸° |
| Work Memory | 4MB | ì‘ì—… ë©”ëª¨ë¦¬ |

#### 5.1.2 ìºì‹œ Pod êµ¬ì„±

**ê¸°ë³¸ ì„¤ì •:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ | bitnami/redis:7.2 | ìµœì‹  ì•ˆì • Redis ë²„ì „ |
| CPU ìš”ì²­ | 100m | ê¸°ë³¸ CPU í• ë‹¹ |
| Memory ìš”ì²­ | 256Mi | ê¸°ë³¸ ë©”ëª¨ë¦¬ í• ë‹¹ |
| CPU ì œí•œ | 500m | ìµœëŒ€ CPU ì‚¬ìš©ëŸ‰ |
| Memory ì œí•œ | 1Gi | ìµœëŒ€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ |

**ë©”ëª¨ë¦¬ ì„¤ì •:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| ë°ì´í„° ì§€ì†ì„± | Disabled | ê°œë°œìš©, ì¬ì‹œì‘ ì‹œ ë°ì´í„° ì†ì‹¤ í—ˆìš© |
| ìµœëŒ€ ë©”ëª¨ë¦¬ | 512MB | ë©”ëª¨ë¦¬ ì‚¬ìš© ì œí•œ |
| ë©”ëª¨ë¦¬ ì •ì±… | allkeys-lru | LRU ë°©ì‹ ìºì‹œ ì œê±° |
| TTL ì„¤ì • | 30ë¶„ | ê¸°ë³¸ ìºì‹œ ë§Œë£Œ ì‹œê°„ |

### 5.2 ë°ì´í„° ê´€ë¦¬ ì „ëµ

#### 5.2.1 ë°ì´í„° ì´ˆê¸°í™”

**Kubernetes Jobì„ í†µí•œ ë°ì´í„° ì´ˆê¸°í™”:**
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìƒì„±: auth, bill_inquiry, product_change ìŠ¤í‚¤ë§ˆ
- ì´ˆê¸° ì‚¬ìš©ì ë°ì´í„°: í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„± (admin, developer, tester)
- ê¸°ë³¸ ìƒí’ˆ ë°ì´í„°: KOS ì—°ë™ì„ ìœ„í•œ ìƒ˜í”Œ ìƒí’ˆ ì •ë³´
- ê¶Œí•œ ì„¤ì •: ê°œë°œíŒ€ìš© ê¸°ë³¸ ê¶Œí•œ ì„¤ì •

**ì‹¤í–‰ ì ˆì°¨:**
```yaml
# ë°ì´í„° ì´ˆê¸°í™” Job
apiVersion: batch/v1
kind: Job
metadata:
  name: data-init-job
spec:
  template:
    spec:
      containers:
      - name: init-container
        image: bitnami/postgresql:16
        env:
        - name: PGPASSWORD
          valueFrom:
            secretKeyRef:
              name: postgresql-secret
              key: postgres-password
        command: ["/bin/bash"]
        args:
        - -c
        - |
          psql -h postgresql -U postgres -f /scripts/init-schema.sql
          psql -h postgresql -U postgres -f /scripts/sample-data.sql
      restartPolicy: OnFailure
```

**ê²€ì¦ ë°©ë²•:**
```bash
# ì´ˆê¸°í™” í™•ì¸
kubectl exec -it postgresql-0 -- psql -U postgres -c "SELECT COUNT(*) FROM users;"
kubectl exec -it postgresql-0 -- psql -U postgres -c "SELECT COUNT(*) FROM products;"
```

#### 5.2.2 ë°±ì—… ì „ëµ

| ì„œë¹„ìŠ¤ | ë°±ì—… ë°©ë²• | ì£¼ê¸° | ë³´ì¡´ ì „ëµ | ì°¸ê³ ì‚¬í•­ |
|--------|----------|------|-----------|----------|
| PostgreSQL | Azure Disk Snapshot | ì¼ì¼ | 7ì¼ ë³´ê´€ | ê°œë°œìš© ë°ì´í„° ìë™ ë°±ì—… |
| Redis | ì—†ìŒ | - | ë©”ëª¨ë¦¬ ì „ìš© | ì¬ì‹œì‘ ì‹œ ìºì‹œ ì¬êµ¬ì„± |
| Application Logs | Azure Monitor Logs | ì‹¤ì‹œê°„ | 14ì¼ ë³´ê´€ | ë””ë²„ê¹…ìš© ë¡œê·¸ |

## 6. KOS-Mock ì„œë¹„ìŠ¤

### 6.1 KOS-Mock êµ¬ì„±

#### 6.1.1 ì„œë¹„ìŠ¤ ì„¤ì •

**KOS-Mock ì„œë¹„ìŠ¤ êµ¬ì„±:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ | kos-mock:latest | ê°œë°œí™˜ê²½ìš© Mock ì„œë¹„ìŠ¤ |
| í¬íŠ¸ | 8080 | HTTP REST API |
| í—¬ìŠ¤ì²´í¬ | /health | ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸ |
| ë°ì´í„°ë² ì´ìŠ¤ | PostgreSQL | Mock ë°ì´í„° ì €ì¥ |

**ì œê³µ API:**
| API ê²½ë¡œ | ë©”ì†Œë“œ | ìš©ë„ | ì‘ë‹µ ì‹œê°„ |
|---------|--------|------|-----------|
| /api/v1/bill-inquiry | POST | ìš”ê¸ˆ ì¡°íšŒ Mock | 100-500ms |
| /api/v1/product-change | POST | ìƒí’ˆ ë³€ê²½ Mock | 200-1000ms |
| /api/v1/customer-info | GET | ê³ ê° ì •ë³´ Mock | 50-200ms |
| /health | GET | í—¬ìŠ¤ ì²´í¬ | 10ms |

#### 6.1.2 Mock ë°ì´í„° ì„¤ì •

**Mock ì‘ë‹µ íŒ¨í„´:**
| ì‘ë‹µ íƒ€ì… | ë¹„ìœ¨ | ì§€ì—°ì‹œê°„ | ìš©ë„ |
|-----------|------|---------|------|
| ì„±ê³µ ì‘ë‹µ | 80% | 100-300ms | ì •ìƒ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸ |
| ì§€ì—° ì‘ë‹µ | 15% | 1-3ì´ˆ | íƒ€ì„ì•„ì›ƒ í…ŒìŠ¤íŠ¸ |
| ì˜¤ë¥˜ ì‘ë‹µ | 5% | 100ms | ì˜¤ë¥˜ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸ |

## 7. ë³´ì•ˆ ì•„í‚¤í…ì²˜

### 7.1 ê°œë°œí™˜ê²½ ë³´ì•ˆ ì •ì±…

#### 7.1.1 ê¸°ë³¸ ë³´ì•ˆ ì„¤ì •

**ë³´ì•ˆ ê³„ì¸µë³„ ì„¤ì •ê°’:**
| ê³„ì¸µ | ì„¤ì • | ìˆ˜ì¤€ | ì„¤ëª… |
|------|------|------|----------|
| L4 ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ | Network Security Group | ê¸°ë³¸ | ê¸°ë³¸ Azure NSG ê·œì¹™ |
| L3 í´ëŸ¬ìŠ¤í„° ë³´ì•ˆ | Kubernetes RBAC | ê¸°ë³¸ | ê°œë°œíŒ€ ì „ì²´ ì ‘ê·¼ ê¶Œí•œ |
| L2 ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ | JWT ì¸ì¦ | ê¸°ë³¸ | ê°œë°œìš© ê³ ì • ì‹œí¬ë¦¿ |
| L1 ë°ì´í„° ë³´ì•ˆ | TLS 1.2 | ê¸°ë³¸ | Pod ê°„ ì•”í˜¸í™” í†µì‹  |

**ê´€ë¦¬ ëŒ€ìƒ ì‹œí¬ë¦¿:**
| ì‹œí¬ë¦¿ ì´ë¦„ | ìš©ë„ | ìˆœí™˜ ì •ì±… | ì €ì¥ ìœ„ì¹˜ |
|-------------|------|----------|----------|
| postgresql-secret | PostgreSQL ì ‘ê·¼ | ìˆ˜ë™ | Kubernetes Secret |
| redis-secret | Redis ì ‘ê·¼ | ìˆ˜ë™ | Kubernetes Secret |
| jwt-signing-key | JWT í† í° ì„œëª… | ìˆ˜ë™ | Kubernetes Secret |
| kos-mock-config | KOS-Mock ì„¤ì • | ìˆ˜ë™ | Kubernetes ConfigMap |

#### 7.1.2 ì‹œí¬ë¦¿ ê´€ë¦¬

**ì‹œí¬ë¦¿ ê´€ë¦¬ ì „ëµ:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| ê´€ë¦¬ ë°©ì‹ | Kubernetes Secrets | ê¸°ë³¸ K8s ë‚´ì¥ ë°©ì‹ |
| ì•”í˜¸í™” ë°©ì‹ | etcd ì•”í˜¸í™” | í´ëŸ¬ìŠ¤í„° ë ˆë²¨ ì•”í˜¸í™” |
| ì ‘ê·¼ ì œì–´ | RBAC | ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ ì ‘ê·¼ ì œì–´ |
| ê°ì‚¬ ë¡œê·¸ | Enabled | Secret ì ‘ê·¼ ë¡œê·¸ ê¸°ë¡ |

### 7.2 Network Policies

#### 7.2.1 ê¸°ë³¸ ì •ì±…

**Network Policy ì„¤ì •:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| Policy ì´ë¦„ | dev-basic-policy | ê°œë°œí™˜ê²½ ê¸°ë³¸ ì •ì±… |
| Pod ì„ íƒì | app=phonebill | ì• í”Œë¦¬ì¼€ì´ì…˜ Pod ëŒ€ìƒ |
| Ingress ê·œì¹™ | ë™ì¼ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ í—ˆìš© | ê°œë°œí™˜ê²½ í¸ì˜ìƒ í—ˆìš©ì  ì •ì±… |
| Egress ê·œì¹™ | ì™¸ë¶€ ì‹œìŠ¤í…œ í—ˆìš© | KOS-Mock ì„œë¹„ìŠ¤ ì ‘ê·¼ í—ˆìš© |

## 8. ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### 8.1 ê¸°ë³¸ ëª¨ë‹ˆí„°ë§

#### 8.1.1 Kubernetes ê¸°ë³¸ ëª¨ë‹ˆí„°ë§

**ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ êµ¬ì„±:**
| êµ¬ì„±ìš”ì†Œ | ë„êµ¬ | ìƒíƒœ | ì„¤ëª… |
|-----------|------|------|----------|
| ë©”íŠ¸ë¦­ ì„œë²„ | Metrics Server | Enabled | ê¸°ë³¸ ë¦¬ì†ŒìŠ¤ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ |
| ëŒ€ì‹œë³´ë“œ | Kubernetes Dashboard | Enabled | ì›¹ ê¸°ë°˜ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ |
| ë¡œê·¸ ìˆ˜ì§‘ | kubectl logs | Manual | ìˆ˜ë™ ë¡œê·¸ í™•ì¸ |

**ê¸°ë³¸ ì•Œë¦¼ ì„ê³„ê°’:**
| ì•Œë¦¼ ìœ í˜• | ì„ê³„ê°’ | ëŒ€ì‘ ë°©ì•ˆ | ì•Œë¦¼ ëŒ€ìƒ |
|-----------|----------|-----------|----------|
| Pod Crash Loop | 5íšŒ ì—°ì† ì¬ì‹œì‘ | ê°œë°œì Slack ì•Œë¦¼ | ê°œë°œíŒ€ |
| Node Not Ready | 5ë¶„ ì´ìƒ | ë…¸ë“œ ìƒíƒœ ì ê²€ | ì¸í”„ë¼íŒ€ |
| High Memory Usage | 85% ì´ìƒ | ë¦¬ì†ŒìŠ¤ í• ë‹¹ ê²€í†  | ê°œë°œíŒ€ |
| Disk Usage | 80% ì´ìƒ | ìŠ¤í† ë¦¬ì§€ ì •ë¦¬ | ì¸í”„ë¼íŒ€ |

#### 8.1.2 ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë‹ˆí„°ë§

**í—¬ìŠ¤ì²´í¬ ì„¤ì •:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| Liveness Probe | /actuator/health/liveness | Spring Boot Actuator |
| Readiness Probe | /actuator/health/readiness | íŠ¸ë˜í”½ ìˆ˜ì‹  ì¤€ë¹„ ìƒíƒœ |
| ì²´í¬ ì£¼ê¸° | 30ì´ˆ | ìƒíƒœ í™•ì¸ ê°„ê²© |
| íƒ€ì„ì•„ì›ƒ | 5ì´ˆ | ì‘ë‹µ ëŒ€ê¸° ì‹œê°„ |

**ìˆ˜ì§‘ ë©”íŠ¸ë¦­ ìœ í˜•:**
| ë©”íŠ¸ë¦­ ìœ í˜• | ë„êµ¬ | ìš©ë„ | ë³´ì¡´ ê¸°ê°„ |
|-----------|------|------|----------|
| JVM Metrics | Micrometer | ê°€ìƒë¨¸ì‹  ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ | 7ì¼ |
| HTTP Request Metrics | Micrometer | API ìš”ì²­ í†µê³„ | 7ì¼ |
| Database Pool Metrics | HikariCP | DB ì—°ê²° í’€ ìƒíƒœ | 7ì¼ |
| Custom Business Metrics | Micrometer | ë¹„ì¦ˆë‹ˆìŠ¤ ì§€í‘œ | 7ì¼ |

### 8.2 ë¡œê¹…

#### 8.2.1 ë¡œê·¸ ìˆ˜ì§‘

**ë¡œê·¸ ìˆ˜ì§‘ ë°©ì‹:**
| ì„¤ì • í•­ëª© | ê°’ | ì„¤ëª… |
|-----------|----|---------|
| ìˆ˜ì§‘ ë°©ì‹ | stdout/stderr | í‘œì¤€ ì¶œë ¥ìœ¼ë¡œ ë¡œê·¸ ì „ì†¡ |
| ì €ì¥ ë°©ì‹ | Azure Container Logs | AKS ê¸°ë³¸ ë¡œê·¸ ì €ì¥ì†Œ |
| ë³´ì¡´ ê¸°ê°„ | 7ì¼ | ê°œë°œí™˜ê²½ ë‹¨ê¸° ë³´ì¡´ |
| ë¡œê·¸ í˜•ì‹ | JSON | êµ¬ì¡°í™”ëœ ë¡œê·¸ í˜•ì‹ |

**ë¡œê·¸ ë ˆë²¨ë³„ ì„¤ì •:**
| ë¡œê±° ìœ í˜• | ë ˆë²¨ | ì„¤ëª… |
|-----------|------|----------|
| Root Logger | INFO | ì „ì²´ ì‹œìŠ¤í…œ ê¸°ë³¸ ë ˆë²¨ |
| Application Logger | DEBUG | ê°œë°œìš© ìƒì„¸ ë¡œê·¸ |
| Database Logger | INFO | ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ë¡œê·¸ |
| External API Logger | DEBUG | ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ ë¡œê·¸ |

## 9. ë°°í¬ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸

| ì»´í¬ë„ŒíŠ¸ ìœ í˜• | ì»´í¬ë„ŒíŠ¸ | ì—­í•  | ì„¤ì • |
|--------------|----------|------|------|
| Container Registry | Azure Container Registry Basic | ì´ë¯¸ì§€ ì €ì¥ì†Œ | phonebilldev.azurecr.io |
| CI | GitHub Actions | ì§€ì†ì  í†µí•© | ì½”ë“œ ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ì´ë¯¸ì§€ ë¹Œë“œ |
| CD | ArgoCD | GitOps ë°°í¬ | ìë™ ë°°í¬, ë¡¤ë°± |
| íŒ¨í‚¤ì§€ ê´€ë¦¬ | Helm | Kubernetes íŒ¨í‚¤ì§€ ê´€ë¦¬ | values-dev.yaml ì„¤ì • |
| í™˜ê²½ë³„ ì„¤ì • | ConfigMap | í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬ | ê°œë°œí™˜ê²½ ì „ìš© ì„¤ì • |
| ì‹œí¬ë¦¿ ê´€ë¦¬ | Kubernetes Secret | ë¯¼ê° ì •ë³´ ê´€ë¦¬ | DB ì—°ê²° ì •ë³´ ë“± |

## 10. ë¹„ìš© ìµœì í™”

### 10.1 ê°œë°œí™˜ê²½ ë¹„ìš© êµ¬ì¡°

#### 10.1.1 ì£¼ìš” ë¹„ìš© ìš”ì†Œ

| êµ¬ì„±ìš”ì†Œ | ì‚¬ì–‘ | ì›”ê°„ ì˜ˆìƒ ë¹„ìš© (USD) | ì ˆì•½ ë°©ì•ˆ |
|----------|------|---------------------|-----------|
| AKS í´ëŸ¬ìŠ¤í„° | ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ | $73 | ê¸°ë³¸ ì„œë¹„ìŠ¤ ê³„ì¸µ ì‚¬ìš© |
| ë…¸ë“œ í’€ (VM) | Standard_B2s Ã— 2 | $60 | Spot Instance ì ìš© |
| Azure Disk | Standard 20GB Ã— 2 | $5 | ê°œë°œìš© ìµœì†Œ ìš©ëŸ‰ |
| Load Balancer | Basic | $18 | ê¸°ë³¸ ê³„ì¸µ ì‚¬ìš© |
| Container Registry | Basic | $5 | ê°œë°œìš© ê¸°ë³¸ ê³„ì¸µ |
| ë„¤íŠ¸ì›Œí‚¹ | ë°ì´í„° ì „ì†¡ | $10 | ë‹¨ì¼ ë¦¬ì „ ì‚¬ìš© |
| **ì´í•©** | | **$171** | **Spot Instanceë¡œ $42 ì ˆì•½ ê°€ëŠ¥** |

#### 10.1.2 ë¹„ìš© ì ˆì•½ ì „ëµ

**ì»´í“¨íŒ… ì˜ì—­ë³„ ì ˆì•½ ë°©ì•ˆ:**
| ì ˆì•½ ë°©ì•ˆ | ì ˆì•½ë¥  | ì ìš© ë°©ë²• | ì˜ˆìƒ ì ˆì•½ ê¸ˆì•¡ |
|-----------|----------|----------|----------------|
| Spot Instances | 70% | ë…¸ë“œ í’€ì— Spot VM ì‚¬ìš© | $42/ì›” |
| ë¹„ì—…ë¬´ì‹œê°„ ìë™ ì¢…ë£Œ | 50% | ì•¼ê°„/ì£¼ë§ í´ëŸ¬ìŠ¤í„° ìŠ¤ì¼€ì¼ë‹¤ìš´ | $30/ì›” |
| ë¦¬ì†ŒìŠ¤ Right-sizing | 20% | requests/limits ìµœì í™” | $12/ì›” |

**ìŠ¤í† ë¦¬ì§€ ì˜ì—­ë³„ ì ˆì•½ ë°©ì•ˆ:**
| ì ˆì•½ ë°©ì•ˆ | ì ˆì•½ë¥  | ì ìš© ë°©ë²• | ì˜ˆìƒ ì ˆì•½ ê¸ˆì•¡ |
|-----------|----------|----------|----------------|
| Standard Disk ì‚¬ìš© | 60% | Premium ëŒ€ì‹  Standard ì‚¬ìš© | ì´ë¯¸ ì ìš© |
| ìŠ¤í† ë¦¬ì§€ í¬ê¸° ìµœì í™” | 30% | ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ í›„ í¬ê¸° ì¡°ì • | $2/ì›” |

**ë„¤íŠ¸ì›Œí‚¹ ì˜ì—­ë³„ ì ˆì•½ ë°©ì•ˆ:**
| ì ˆì•½ ë°©ì•ˆ | ì ˆì•½ë¥  | ì ìš© ë°©ë²• | ì˜ˆìƒ ì ˆì•½ ê¸ˆì•¡ |
|-----------|----------|----------|----------------|
| Basic Load Balancer | 50% | Standard ëŒ€ì‹  Basic ì‚¬ìš© | ì´ë¯¸ ì ìš© |
| ë‹¨ì¼ ë¦¬ì „ ë°°í¬ | 100% | ë°ì´í„° ì „ì†¡ ë¹„ìš© ìµœì†Œí™” | $5/ì›” |

## 11. ê°œë°œí™˜ê²½ ìš´ì˜ ê°€ì´ë“œ

### 11.1 ì¼ìƒ ìš´ì˜

#### 11.1.1 í™˜ê²½ ì‹œì‘/ì¢…ë£Œ

**í™˜ê²½ ì‹œì‘ ì ˆì°¨:**
```bash
# í´ëŸ¬ìŠ¤í„° ìŠ¤ì¼€ì¼ì—…
az aks scale --resource-group phonebill-dev-rg --name phonebill-dev-aks --node-count 2

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘
kubectl scale deployment auth-service --replicas=1
kubectl scale deployment bill-inquiry-service --replicas=1
kubectl scale deployment product-change-service --replicas=1

# ë°±í‚¹ ì„œë¹„ìŠ¤ ì‹œì‘
kubectl scale statefulset postgresql --replicas=1
kubectl scale deployment redis --replicas=1

# ìƒíƒœ í™•ì¸
kubectl get pods -w
```

**í™˜ê²½ ì¢…ë£Œ ì ˆì°¨ (ì•¼ê°„/ì£¼ë§):**
```bash
# ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ
kubectl scale deployment --replicas=0 --all

# ë°±í‚¹ ì„œë¹„ìŠ¤ëŠ” ë°ì´í„° ë³´ì¡´ì„ ìœ„í•´ ìœ ì§€
# í´ëŸ¬ìŠ¤í„° ìŠ¤ì¼€ì¼ë‹¤ìš´ (ë¹„ìš© ì ˆì•½)
az aks scale --resource-group phonebill-dev-rg --name phonebill-dev-aks --node-count 1
```

#### 11.1.2 ë°ì´í„° ê´€ë¦¬

**ê°œë°œ ë°ì´í„° ì´ˆê¸°í™”:**
```bash
# ë°ì´í„° ì´ˆê¸°í™” Job ì‹¤í–‰
kubectl apply -f k8s/jobs/data-init-job.yaml

# ì´ˆê¸°í™” ì§„í–‰ ìƒí™© í™•ì¸
kubectl logs -f job/data-init-job

# ë°ì´í„° ì´ˆê¸°í™” í™•ì¸
kubectl exec -it postgresql-0 -- psql -U postgres -c "SELECT COUNT(*) FROM users;"
```

**ê°œë°œ ë°ì´í„° ë°±ì—…:**
```bash
# ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
kubectl exec postgresql-0 -- pg_dump -U postgres phonebill > backup-$(date +%Y%m%d).sql

# Azure Disk ìŠ¤ëƒ…ìƒ· ìƒì„±
az snapshot create \
  --resource-group phonebill-dev-rg \
  --name postgresql-snapshot-$(date +%Y%m%d) \
  --source postgresql-disk
```

**ë°ì´í„° ë³µì›:**
```bash
# SQL íŒŒì¼ë¡œë¶€í„° ë³µì›
kubectl exec -i postgresql-0 -- psql -U postgres phonebill < backup.sql

# ìŠ¤ëƒ…ìƒ·ìœ¼ë¡œë¶€í„° ë””ìŠ¤í¬ ë³µì›
az disk create \
  --resource-group phonebill-dev-rg \
  --name postgresql-restored-disk \
  --source postgresql-snapshot-20250108
```

### 11.2 íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

#### 11.2.1 ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°

| ë¬¸ì œ ìœ í˜• | ì›ì¸ | í•´ê²°ë°©ì•ˆ | ì˜ˆë°©ë²• |
|-----------|------|----------|----------|
| Pod Pending | ë¦¬ì†ŒìŠ¤ ë¶€ì¡± | ë…¸ë“œ ì¶”ê°€ ë˜ëŠ” ë¦¬ì†ŒìŠ¤ ì¡°ì • | ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ |
| Database Connection Failed | PostgreSQL Pod ì¬ì‹œì‘ | Pod ë¡œê·¸ í™•ì¸ ë° ì¬ì‹œì‘ | Health Check ê°•í™” |
| Service Unavailable | Ingress ì„¤ì • ì˜¤ë¥˜ | Ingress ê·œì¹™ í™•ì¸ ë° ìˆ˜ì • | ë°°í¬ ì „ ì„¤ì • ê²€ì¦ |
| Out of Memory | ë©”ëª¨ë¦¬ í•œê³„ ì´ˆê³¼ | Memory Limits ì¦ëŒ€ | ë©”ëª¨ë¦¬ ì‚¬ìš© íŒ¨í„´ ë¶„ì„ |
| Disk Full | ë¡œê·¸ íŒŒì¼ ê³¼ë‹¤ | ë¡œê·¸ ì •ë¦¬ ë° ë³´ì¡´ ì •ì±… ìˆ˜ì • | ë¡œê·¸ ìˆœí™˜ ì •ì±… ì„¤ì • |

**ë¬¸ì œ í•´ê²° ì ˆì°¨:**
```bash
# 1. Pod ìƒíƒœ í™•ì¸
kubectl get pods -o wide
kubectl describe pod <pod-name>

# 2. ë¡œê·¸ í™•ì¸
kubectl logs <pod-name> --tail=50

# 3. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸
kubectl top pods
kubectl top nodes

# 4. ì„œë¹„ìŠ¤ ì—°ê²° í™•ì¸
kubectl get svc
kubectl describe svc <service-name>

# 5. ë„¤íŠ¸ì›Œí¬ ì •ì±… í™•ì¸
kubectl get networkpolicy
kubectl describe networkpolicy <policy-name>
```

## 12. ê°œë°œí™˜ê²½ íŠ¹ì„± ìš”ì•½

**í•µì‹¬ ì„¤ê³„ ì›ì¹™**: ë¹ ë¥¸ ê°œë°œ > ë¹„ìš© íš¨ìœ¨ > ë‹¨ìˆœì„± > ì‹¤í—˜ì„±  
**ì£¼ìš” ì œì•½ì‚¬í•­**: 95% ê°€ìš©ì„±, ì œí•œì  í™•ì¥ì„±, ê¸°ë³¸ ë³´ì•ˆ ìˆ˜ì¤€  
**ìµœì í™” ëª©í‘œ**: ê°œë°œíŒ€ ìƒì‚°ì„± í–¥ìƒ, ë¹ ë¥¸ í”¼ë“œë°± ë£¨í”„, ë¹„ìš© íš¨ìœ¨ì  ìš´ì˜

ì´ ê°œë°œí™˜ê²½ì€ **í†µì‹ ìš”ê¸ˆ ê´€ë¦¬ ì„œë¹„ìŠ¤ì˜ ë¹ ë¥¸ MVP ê°œë°œê³¼ ê²€ì¦**ì— ìµœì í™”ë˜ì–´ ìˆìœ¼ë©°, Azureì˜ ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ìš´ì˜ ë¶€ë‹´ì„ ìµœì†Œí™”í•˜ë©´ì„œë„ ì‹¤ì œ ìš´ì˜í™˜ê²½ê³¼ ìœ ì‚¬í•œ ì•„í‚¤í…ì²˜ íŒ¨í„´ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.